# Chunking 策略对比测试文档

## 使用说明

本文档用于测试**字符递归分割**和**语义分割**两种 chunking 策略的差异。

### 测试步骤

1. 使用默认的**字符递归分割**导入此文档
2. 提问："深度学习和机器学习有什么区别？"
3. 在设置中切换到**语义分割**策略
4. 删除此文档，重新导入
5. 提问相同问题，对比检索结果

### 预期差异

- **字符分割**：可能在句子或段落中间截断，导致上下文不完整
- **语义分割**：按主题边界分割，每个块都是完整的主题

---

## 第一部分：机器学习基础

机器学习是人工智能的一个分支，它使计算机系统能够从数据中学习并改进。机器学习的核心思想是让计算机通过经验自动改进性能，而不需要明确编程。

传统的编程方式是程序员编写规则和逻辑，计算机按照这些规则执行任务。但机器学习则不同，它通过分析大量数据来发现模式和规律。

机器学习主要分为三大类型。第一类是监督学习，需要标注好的训练数据，比如图像分类任务。第二类是无监督学习，从未标注的数据中发现模式，比如聚类分析。第三类是强化学习，通过奖励机制来学习最优策略。

## 第二部分：深度学习的兴起

深度学习是机器学习的一个子领域，它使用多层神经网络来学习数据的层次化表示。深度学习的"深度"指的是神经网络的层数。

传统的机器学习方法在处理图像、语音等复杂数据时需要人工设计特征。但深度学习可以自动从原始数据中学习特征表示，这是它的最大优势。

卷积神经网络（CNN）是深度学习中用于图像处理的经典架构。它通过卷积层提取图像的局部特征，通过池化层降低数据维度，最后通过全连接层进行分类。CNN 在图像识别、目标检测等任务中取得了突破性进展。

循环神经网络（RNN）则专门用于处理序列数据。RNN 的特点是具有记忆能力，可以利用之前的信息来处理当前的输入。这使得 RNN 在自然语言处理、语音识别等领域表现出色。

## 第三部分：Transformer 架构

Transformer 是 2017 年提出的革命性架构，彻底改变了自然语言处理领域。它摒弃了 RNN 的顺序处理方式，采用自注意力机制来并行处理序列数据。

自注意力机制允许模型在处理每个词时关注输入序列中的所有其他词。这种机制使得模型能够捕捉长距离依赖关系，而不像 RNN 那样受到梯度消失问题的困扰。

BERT 和 GPT 是基于 Transformer 的两个代表性模型。BERT 使用双向编码器，通过掩码语言模型进行预训练。GPT 则使用单向解码器，通过下一词预测任务进行预训练。这两种模型在各自的应用场景中都取得了显著成功。

## 第四部分：向量数据库与 RAG

向量数据库是专门用于存储和检索高维向量的数据库系统。在 AI 应用中，文本、图像等数据会被转换为向量表示，然后存储在向量数据库中。

Embedding 是将离散的数据（如文本）转换为连续向量空间中的点的过程。相似的内容在向量空间中距离较近，这使得我们可以通过向量相似度来进行语义搜索。

RAG（检索增强生成）是一种结合了信息检索和语言生成的技术。它首先从知识库中检索相关文档，然后将检索结果作为上下文提供给语言模型，从而生成更准确、更有依据的回答。

RAG 的工作流程包括三个关键步骤：文档索引、相似度检索和增强生成。文档索引阶段将知识库文档转换为向量并存储；检索阶段根据用户问题找到最相关的文档；生成阶段使用检索到的上下文生成回答。

## 第五部分：Chunking 策略

Chunking 是将长文档分割成小块的过程，这是 RAG 系统中的关键步骤。合理的分块策略可以提高检索精度和生成质量。

字符递归分割是最常用的方法，它按照固定的字符数和分隔符优先级进行分割。这种方法简单高效，但可能会在语义边界上切断内容。

语义分割则是根据内容的语义相似度来确定分块边界。它会计算相邻句子的相似度，当相似度低于阈值时就进行分割。这种方法能保证每个块都是语义完整的，但计算成本较高。

选择哪种策略取决于具体需求。如果追求速度和效率，字符分割是更好的选择。如果追求检索精度，语义分割则更有优势。在实际应用中，也可以结合两种方法，先用语义分割做粗分，再用字符分割做细分。

## 测试问题列表

使用不同的 chunking 策略导入此文档后，可以尝试以下问题来对比检索效果：

1. **概念对比**："深度学习和机器学习有什么区别？"
   - 期望：能够检索到第一和第二部分的相关内容

2. **技术细节**："CNN 是如何工作的？"
   - 期望：准确定位到第二部分的 CNN 描述

3. **架构理解**："Transformer 的自注意力机制是什么？"
   - 期望：检索到第三部分的完整解释

4. **应用场景**："RAG 系统是如何工作的？"
   - 期望：检索到第四部分的工作流程描述

5. **策略选择**："什么时候应该使用语义分割？"
   - 期望：检索到第五部分的策略对比分析

## 评估标准

### 字符递归分割预期表现

- ✅ **优势**：分块数量稳定（约 500 字符/块），检索速度快
- ⚠️ **问题**：可能将"CNN 在图像识别"这样的句子从中间截断
- ⚠️ **问题**：跨段落的主题可能被分散到不同块中

### 语义分割预期表现

- ✅ **优势**：每个主题（机器学习、深度学习、Transformer、RAG、Chunking）独立成块
- ✅ **优势**：检索到的块语义完整，上下文连贯
- ⚠️ **问题**：块大小不均匀（可能 200-800 字符不等）
- ⚠️ **问题**：首次导入需要额外时间计算 Embedding

## 结论

通过对比测试，您可以直观感受到两种策略的差异，从而为您的知识库选择最合适的 chunking 策略。
